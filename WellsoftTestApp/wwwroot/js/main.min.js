function GetPageData(n,t){$("#tblData").empty();$("#paged").empty();const i=window.location.href.split("/");var r=i[i.length-1].toString();const u=`/Stocktaking/Get${r}`;$.getJSON(u,{pageNumber:n,pageSize:t},function(n){var i;i=r.includes("Companies")?CreateTable(n,"Company",1):CreateTable(n,"Employee",2);$("#tblData").append(i);PaggingTemplate(n.totalPages,n.currentPage,t)})}function CreateTable(n,t,i){var u="",r="",f;for(let e=0;e<n.data.length;e++){f=Object.keys(n.data[e]);t==="Employee"&&(r=r+"<td>"+n.data[e].company.name+"<\/td>");for(let t=i;t<f.length;t++)r=r+"<td>"+n.data[e][f[t]]+"<\/td>";u=u+"<tr>"+r+'<td><button  type="button" class="btn btn-primary btn-sm" id="btnEdit'+t+'" data-id="'+n.data[e].id+'" data-controller="Stocktaking" data-action="Edit'+t+'" >Редактировать<\/button> | <button  type="button" class="btn btn-danger btn-sm" id="btnDelete" data-id="'+n.data[e].id+'" data-controller="Stocktaking" data-action="Delete'+t+'" data-body-message="Удалить '+n.data[e].name+'?"">Удалить<\/button><\/td><\/tr>';r=""}return u}function PaggingTemplate(n,t,i){var r="",u=n,f=t,o=Array.from(Array(u),(n,t)=>t+1),c=u,h,s,e;if(u!==f&&(h=f+1),s=1,f>1&&(s=f-1),u<=0){r="<p>Нет элементов<\/p>";$("#paged").append(r);return}r="<p>"+f+" из "+u+" стр.<\/p>";r=r+'<ul class="pagination"><li class="page-item"><a class="page-link" href="#" onclick="GetPageData(1,'+i+')">Первая<\/a><\/li><li><a href="#" onclick="GetPageData('+s+')"><\/a>';e="";for(let n=0;n<o.length;n++)e=e+'<li class="page-item" ><a class="page-link" onclick="GetPageData('+o[n]+","+i+')" href="#">'+o[n]+" &nbsp;&nbsp;<\/a><\/li>";r=r+e+'<a href="#" onclick="GetPageData('+h+')" ><\/a><\/li><li class="page-item"><a class="page-link" href="#" onclick="GetPageData('+c+","+i+')">Последняя<\/a><\/li><\/ul>Показывать по: <select class="custom-select" id="selectedId"><option value="3">3<\/option><option value="10">10<\/option><option value="15">15<\/option><\/select>';$("#paged").append(r);$(`#selectedId option[value=${i}]`).prop("selected",!0);$("#selectedId").change(function(){GetPageData(1,$(this).val())})}$(document).ready(function(){var t,n;GetPageData(1,3);$("#btnAddCompany").click(function(){$("#addModal").modal()});$("body").on("click","#btnEditCompany",function(i){i.preventDefault();n=i.target;const r=$(n).data("id"),u=$(n).data("controller"),f=$(n).data("action");t=`/${u}/${f}/${r}`;$("#editModal").modal("show");$.get(t).done(n=>{$("#Id").val(n.id),$("#NameEdit").val(n.name)}).fail(()=>{}).always(()=>{});$("#confirmEdit").on("click",()=>{$("#editModal").modal("hide")})});$("#btnAddEmployee").click(function(){$("#addModal").modal("show");$.get("/Stocktaking/GetAllCompanies").done(n=>{$.each(n,function(n,t){$("#CompanyId").append(`<option value="${t.id}">${t.name}</option>`)})}).fail(()=>{}).always(()=>{})});$("body").on("click","#btnEditEmployee",function(t){t.preventDefault();n=t.target;var i=$(n).data("id"),r=$(n).data("controller"),u=$(n).data("action");const f=`/${r}/${u}?id=${i}`;$("#editModal").modal("show");$("#CompanyIdEdit").find("option").remove();$.get("/Stocktaking/GetAllCompanies").done(n=>{$.each(n,function(n,t){$("#CompanyIdEdit").append(`<option value="${t.id}">${t.name}</option>`)})}).fail(()=>{}).always(()=>{});$.get(f).done(n=>{$("#Id").val(n.id),$("#NameEdit").val(n.name),$("#DescriptionEdit").val(n.description),$("#AgeEdit").val(n.age),$("#CompanyIdEdit").val(n.company.id)}).fail(()=>{}).always(()=>{})});$("body").on("click","#btnDelete",function(i){i.preventDefault();n=i.target;var r=$(n).data("id"),u=$(n).data("controller"),f=$(n).data("action"),e=$(n).data("body-message");$("body").append(`<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
            <div class="modal-content">
            <div class="modal-header">
            </div>
            <div class="modal-body" id="deleteModalBody">

            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal" id="bntCancelDelete">Закрыть</button>
            <button type="button" class="btn btn-danger" id="confirmDelete">Удалить</button>
            </div>
            </div>
            </div>
            </div>`);t=`/${u}/${f}?id=${r}`;$("#deleteModalBody").text(e);$("#deleteModal").modal("show");$.get(t).done(()=>{t=`/${u}/${f}/${r}`;$("#confirmDelete").on("click",()=>{var n=JSON.stringify({id:r});$.post(t,n).done(()=>{$("#deleteModal").remove(),$(".modal-backdrop").remove(),GetPageData(1,$("#selectedId").val())})})});$("body").on("click","#bntCancelDelete",function(){$("#deleteModal").remove();$(".modal-backdrop").remove()})})});